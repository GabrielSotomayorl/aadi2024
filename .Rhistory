ylim(0, 25) +
geom_point(shape = 21, fill = "#40E0D0", size = 1) +
ylab("% Pobreza") +
xlab("Edad") +
labs(title = "Porcentaje de pobreza según edad por zona",
caption = "Fuente: Encuesta Casen 2022") +
theme_bw() +
facet_wrap(as_factor(casen_pob_a$area))
head(casen_pob_a)
casen %>%
ggplot(aes(x = as_factor(sexo))) +
geom_bar(width = 0.4,  fill= rgb(0.1,0.3,0.5,0.7), aes(y = (..count..)/sum(..count..))) +
scale_x_discrete("Sexo") +
scale_y_continuous("Porcentaje",labels=scales::percent)+
labs(title = "Frecuencia absoluta de sexo en Casen 2022",
caption = "Fuente: Encuesta Casen 2022") +
theme_bw()
casen %>%
filter(region == 5, ytrabajocor <= 5000000) %>%
ggplot(aes(x = esc, y = ytrabajocor)) +
geom_point(alpha = 0.1) +  # Aumentar la transparencia para mejorar la visualización de la densidad
geom_smooth(method = "lm", color = "red", se = FALSE) +  # Añadir una línea de tendencia sin la banda de confianza para claridad
scale_x_continuous(name = "Años de Escolaridad") +  # Renombrar eje X
scale_y_continuous(name = "Ingresos por Trabajo (CLP)", labels = scales::comma) +  # Renombrar eje Y y formatear como números
labs(title = "Relación entre Escolaridad e Ingresos por Trabajo",
subtitle = "Región de Valparaíso, Encuesta Casen",
caption = "Fuente: Encuesta Casen 2022") +
theme_bw() +  # Usar un tema de fondo blanco y negro para claridad
theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotar las etiquetas del eje X para mejorar la legibilidad
blogdown::serve_site()
temp <- tempfile() #Creamos un archivo temporal
download.file("https://observatorio.ministeriodesarrollosocial.gob.cl/storage/docs/bienestar-social/Base_de_datos_EBS_2021_SPSS.sav.zip",temp) #descargamos los datos
ebs <- haven::read_sav(unz(temp, "Base de datos EBS 2021 SPSS.sav")) #cargamos los datos
unlink(temp); remove(temp) #eliminamos el archivo temporal
estatura <- c(1.70, 1.82, 1.65, 1.75, 1.60, 1.68, 1.77)
peso <- c(70, 82, 60, 76, 58, 73, 85)
nombres <- c("Ana", "Bruno", "Carla", "David", "Elena", "Fernando", "Gloria")
# Creación del dataframe
personas_df <- data.frame(nombres, estatura, peso)
# Crear tramos de IMC basados en la clasificación estándar
personas_df$tramo_IMC <- cut(personas_df$IMC,
breaks = c(-Inf, 18.5, 25, 30, Inf),
labels = c("Bajo peso", "Peso normal", "Sobrepeso", "Obesidad"),
include.lowest = TRUE)
# Tabla de tramos de IMC
tabla_IMC <- table(personas_df$tramo_IMC)
# Mostrar la tabla
print(tabla_IMC)
# Vectores de estatura (en metros), peso (en kg) y nombres
estatura <- c(1.70, 1.82, 1.65, 1.75, 1.60, 1.68, 1.77)
peso <- c(70, 82, 60, 76, 58, 73, 85)
nombres <- c("Ana", "Bruno", "Carla", "David", "Elena", "Fernando", "Gloria")
# Creación del dataframe
personas_df <- data.frame(nombres, estatura, peso)
# Calcular el IMC
personas_df$IMC <- personas_df$peso / (personas_df$estatura^2)
# Crear tramos de IMC basados en la clasificación estándar
personas_df$tramo_IMC <- cut(personas_df$IMC,
breaks = c(-Inf, 18.5, 25, 30, Inf),
labels = c("Bajo peso", "Peso normal", "Sobrepeso", "Obesidad"),
include.lowest = TRUE)
# Tabla de tramos de IMC
tabla_IMC <- table(personas_df$tramo_IMC)
# Mostrar la tabla
print(tabla_IMC)
ebas$a1
ebs$a1
table(ebs$a1)
mean(ebs$a1)
library(tidyverse)
ebs %>%
group_by(sexo)
mean(ebs$affective_sw)
ebs %>%
group_by(sexo) %>%
summarise(media = mean(affective_sw))
ebs %>%
group_by(sexo) %>%
summarise(media = mean(affective_sw),
desviacion = mean(affective_sw))
ebs %>%
group_by(sexo) %>%
summarise(media = mean(affective_sw),
desviacion = sd(affective_sw))
ebs %>%
group_by(qaut) %>%
summarise(media = mean(affective_sw),
desviacion = sd(affective_sw))
ebs %>%
group_by(qaut) %>%
summarise(media = mean(affective_sw))
ebs %>%
group_by(qaut) %>%
summarise(media = mean(affective_sw)) %>%
ggplot()
ebs %>%
group_by(qaut) %>%
summarise(media = mean(affective_sw)) %>%
ggplot() +
aes(media)
ebs %>%
group_by(qaut) %>%
summarise(media = mean(affective_sw)) %>%
ggplot() +
aes(media, qaut) +
geom
ebs %>%
group_by(qaut) %>%
summarise(media = mean(affective_sw)) %>%
ggplot() +
aes(media, qaut) +
geom_bar()
ebs %>%
group_by(qaut) %>%
summarise(media = mean(affective_sw)) %>%
ggplot() +
aes(x = media, y = qaut) +
geom_point()
ebs %>%
group_by(qaut) %>%
summarise(media = mean(affective_sw)) %>%
ggplot() +
aes(y = media, x = qaut) +
geom_point()
ebs %>%
ggplot() +
aes(y = media, x = qaut) +
geom_point()
ebs %>%
ggplot() +
aes(y = affective_sw) +
geom_point()
ebs %>%
ggplot() +
aes(y = affective_sw) +
geom_point()
ebs %>%
ggplot() +
aes(x = affective_sw) +
geom_point()
ebs %>%
ggplot() +
aes(x = affective_sw) +
geom_hit()
ebs %>%
ggplot() +
aes(x = affective_sw) +
geom_histogram()
ebs %>%
ggplot() +
aes(x = affective_sw) +
geom_bar()
ebs %>%
ggplot() +
aes(x = affective_sw) +
geom_bar() %>%
facet_wrap(sexo)
ebs %>%
ggplot() +
aes(x = affective_sw) +
geom_bar() +
facet_wrap(sexo)
ebs %>%
ggplot() +
aes(x = affective_sw) +
geom_bar() +
facet_wrap(ebs$sexo)
ebs %>%
ggplot() +
aes(x = a1) +
geom_bar() +
facet_wrap(ebs$sexo)
ebs %>%
filter(edad > 60) %>%
ggplot() +
aes(x = a1) +
geom_bar() +
facet_wrap(ebs$sexo)
ebs$p1
ebs$p2
ebs %>%
filter(l1 > 60) %>%
ggplot() +
aes(x = a1) +
geom_bar() +
facet_wrap(ebs$sexo)
ebs %>%
filter(l1 > 60) %>%
ggplot() +
aes(x = a1) +
geom_bar()
ebs %>%
filter(l1 > 60) %>%
ggplot() +
aes(x = as_factor(a1)) +
geom_bar()
blogdown:::preview_site()
blogdown:::preview_site()
# Importar datos
temp <- tempfile() #Creamos un archivo temporal
download.file("https://observatorio.ministeriodesarrollosocial.gob.cl/storage/docs/bienestar-social/Base_de_datos_EBS_2021_SPSS.sav.zip",temp) #descargamos los datos
data <- haven::read_sav(unz(temp, "Base de datos EBS 2021 SPSS.sav")) #cargamos los datos
unlink(temp); remove(temp) #eliminamos el archivo temporal
var(edad)
var(data$l1)
sd(data$l1)
cor(data$l1, data$affective_sw)
cor(data$l1, data$affective_sw)
cov(data$l1, data$affective_sw)
library(texreg)
library(psych)
cor(data$a3_1, data$a3_3)
polychoric(data$a3_1, data$a3_3)
polychoric(data %>%  select(a3_1, a3_3))
library(dplyr)
cor(data$a3_1, data$a3_3)
polychoric(data %>%  select(a3_1, a3_3))
screenreg( lm(affective_sw ~ sexo))
screenreg( lm(affective_sw ~ sexom data = data))
screenreg( lm(affective_sw ~ sexom, data = data))
screenreg( lm(affective_sw ~ sexo, data = data))
screenreg( lm(affective_sw ~ sexo + edad, data = data))
screenreg( lm(affective_sw ~ sexo +l1 , data = data))
screenreg( lm(affective_sw ~ l1 , data = data))
screenreg( lm(affective_sw ~ sexo +l1 , data = data))
screenreg( lm(affective_sw ~ sexo +l1 , data = data %>% filter(region == 12)))
screenreg( lm(affective_sw ~ sexo +l1 , data = data %>% filter(region == 5)))
screenreg( lm(affective_sw ~ factor(sexo) +l1 , data = data %>% filter(region == 5)))
screenreg( lm(affective_sw ~ factor(sexo) +l1 , data = data %>% filter(region == 5)))
summary(data$l1)
var(data$l1) #edad
sd(data$l1) #edad
hist(data$l1)
17.68446*17.68446
var(data$l1) #edad
sd(data$l1) #edad
17.68446*17.68446
var(data$l1) #edad
sd(data$l1) #edad
cov(data$l1, data$affective_sw)  #edad y balance emocional
cor(data$l1, data$affective_sw)  #edad y balance emocional
plot(data$l1, data$affective_sw)
cor(data$l1, data$affective_sw)  #edad y balance emocional
cor(data$a3_1, data$a3_3)
polychoric(data %>%  select(a3_1, a3_3))
cor(data$l1, data$affective_sw)  #edad y balance emocional
screenreg( lm(affective_sw ~ factor(sexo) +l1 , data = data %>% filter(region == 5)))
screenreg( lm(affective_sw ~ l1 , data = data %>% filter(region == 5)))
screenreg( lm(affective_sw ~ factor(sexo) +l1 , data = data %>% filter(region == 5)))
screenreg( lm(affective_sw ~ factor(sexo) +l1 , data = data))
blogdown:::preview_site()
temp <- tempfile() #Creamos un archivo temporal
download.file("http://observatorio.ministeriodesarrollosocial.gob.cl/storage/docs/casen/2020/Casen_en_Pandemia_2020_revisada202209.sav.zip",temp) #descargamos los datos
base <- haven::read_sav(unz(temp, "Casen_en_Pandemia_2020_revisada202209.sav")) #cargamos los datos
unlink(temp); remove(temp) #eliminamos el archivo temporal
if (!require("pacman")) install.packages("pacman")
pacman::p_load(haven,texreg,corrplot,coefplot,ggplot2,sjPlot,summarytools,dplyr,
lmtest,sandwich)
lm(yautcor~ esc,data = base)
lm(yautcor ~ esc,data = base)
modelo1 <- lm(yautcor ~ esc,data = base)
summary(modelo1)
modelo2 <- lm(yautcor~ esc+ edad+ as_factor(sexo),data = base)
modelo3 <- lm(yautcor~ esc+ edad+ as_factor(sexo),data = base,weights = expr)
modelo2 <- lm(yautcor~ esc+ edad+ as_factor(sexo),data = base)
modelo3 <- lm(yautcor~ esc+ edad+ as_factor(sexo),data = base, weights = expr)
htmlreg(list(modelo1,modelo2,modelo3), custom.coef.names = c("Intercepto","Escolaridad","Edad","Sexo (ref. Hombre)"))
screenreg(list(modelo1,modelo2,modelo3), custom.coef.names = c("Intercepto","Escolaridad","Edad","Sexo (ref. Hombre)"))
screenreg(modelo3)
screenreg(modelo3,custom.coef.names = c("Intercepto","Escolaridad","Edad","Sexo (ref. Hombre)"))
screenreg(list(modelo1,modelo2,modelo3), custom.coef.names = c("Intercepto","Escolaridad","Edad","Sexo (ref. Hombre)"))
screenreg(lm(yautcor ~ as_factor(sexo), data = base))
coefplot(modelo3)
coefplot(modelo3)+scale_y_discrete(labels=c("Intercepto","Escolaridad","Edad","Sexo","Sexo (ref. Hombre)"))+
labs(title = "Gráfico de coeficientes",subtitle = "Modelo 3")+ylab("Coeficientes")
coefplot(modelo3)+scale_y_discrete(labels=c("Intercepto","Escolaridad","Edad","Sexo","Sexo (ref. Hombre)"))+
labs(title = "Gráfico de coeficientes",subtitle = "Modelo 3")+ylab("Coeficientes") + theme_minimal()
coefplot(modelo3)+scale_y_discrete(labels=c("Intercepto","Escolaridad","Edad","Sexo","Sexo (ref. Hombre)"))+
labs(title = "Gráfico de coeficientes",subtitle = "Modelo 3")+ylab("Coeficientes") + theme_minimal() + xlab("ingresos")
coefplot(modelo3)+scale_y_discrete(labels=c("Intercepto","Escolaridad","Edad","Sexo","Sexo (ref. Hombre)"))+
labs(title = "Gráfico de coeficientes",subtitle = "Modelo 3")+ylab("Coeficientes") + theme_minimal() + xlab("ingresos")
n <- nobs(modelo3) #n de observaciones
coef(modelo3)
length(coef(modelo3))
k <- length(coef(modelo3))
4/(n-k-1)
dcook <- 4/(n-k-1)
broom::augment_columns(modelo3,data = base)
final <- broom::augment_columns(modelo3,data = base)
final$id <- as.numeric(row.names(final))
ggplot(final, aes(id, .cooksd))+
geom_bar(stat="identity", position="identity")+
xlab("Obs. Number")+ylab("Cook's distance")+
geom_hline(yintercept=dcook)+
geom_text(aes(label=ifelse((.cooksd>dcook),id,"")),
vjust=-0.2, hjust=0.5)
modelo3$coefficients
plot(modelo3)
blogdown::serve_site()
blogdown:::preview_site()
pagos <- c(
182716,
50243,
60889,
2794,
297302,
4399, # Asumiendo que el monto es 4.399 y no 4.399.000
257143,
514287,
257143,
0,
66133,
13303, # Ajustado de 13.03 a 13.303 basándonos en el formato de los demás números
46078,
121782,
49638, # Ajustado de 49.638 asumiendo que es un error de OCR
19434,
10712,
26454,
0,
349606, # Ajustado de 349,606 asumiendo que la coma es un error de OCR
50838
)
sum(pagos)
pagos <- c(
182716,
50243,
60889,
2794,
1101080
297302,
pagos <- c(
182716,
50243,
60889,
2794,
1101080
297302,
pagos <- c(
182716,
50243,
60889,
2794,
1101080,
297302,
4399, # Asumiendo que el monto es 4.399 y no 4.399.000
257143,
514287,
257143,
0,
66133,
13303, # Ajustado de 13.03 a 13.303 basándonos en el formato de los demás números
46078,
121782,
49638, # Ajustado de 49.638 asumiendo que es un error de OCR
19434,
10712,
26454,
0,
349606, # Ajustado de 349,606 asumiendo que la coma es un error de OCR
50838
)
sum(pagos)
blogdown:::preview_site()
blogdown::serve_site()
# Importar datos
temp <- tempfile() #Creamos un archivo temporal
download.file("https://observatorio.ministeriodesarrollosocial.gob.cl/storage/docs/bienestar-social/Base_de_datos_EBS_2021_SPSS.sav.zip",temp) #descargamos los datos
data <- haven::read_sav(unz(temp, "Base de datos EBS 2021 SPSS.sav")) #cargamos los datos
unlink(temp); remove(temp) #eliminamos el archivo temporal
# Importar datos
temp <- tempfile() #Creamos un archivo temporal
download.file("https://observatorio.ministeriodesarrollosocial.gob.cl/storage/docs/bienestar-social/Base_de_datos_EBS_2021_SPSS.sav.zip",temp) #descargamos los datos
data <- haven::read_sav(unz(temp, "Base de datos EBS 2021 SPSS.sav")) #cargamos los datos
unlink(temp); remove(temp) #eliminamos el archivo temporal
table(data$b9_1)
table(data$b9_1, useNA = "ifany")
table(data$b9_2, useNA = "ifany")
table(data$b9_3, useNA = "ifany")
table(data$b9_4, useNA = "ifany")
data %>%
mutate(b9 = b9_1+b9_2+b9_3+b9_4)
library(tidyverse)
data %>%
mutate(b9 = b9_1+b9_2+b9_3+b9_4)
data<-data %>%
mutate(b9 = b9_1+b9_2+b9_3+b9_4)
summary(data$b9)
data<-data %>%
mutate(b9 = b9_1+b9_2+b9_3+b9_4,
sd = ifelse(b9 > median(b9), 1,0))
summary(data$sd)
table(data$sd)
data$sexo
glm(sd ~  sexo,data = data)
screenreg(glm(sd ~  sexo,data = data))
library(texreg)
screenreg(glm(sd ~  sexo,data = data))
screenreg(glm(sd ~  as_factor(sexo),data = data))
data$l1
screenreg(glm(sd ~  as_factor(sexo) + l1,data = data))
table(data$i4)
data<-data %>%
mutate(b9 = b9_1+b9_2+b9_3+b9_4,
sd = ifelse(b9 > median(b9), 1,0),
i4 = ifelse(i4 == 9,NA, i4))
screenreg(glm(sd ~  as_factor(sexo) + l1 + i4,data = data))
screenreg(glm(sd ~  as_factor(sexo) + l1 + factor(i4),data = data))
library(sjmisc)
find_var(data, "phq")
frq(data$phq4)
table(data$b9, data$phq4)
table(data$sd, data$phq4)
find_var(data, "edu")
screenreg(glm(sd ~  as_factor(sexo) + l1 + factor(i4) + neduc,data = data))
screenreg(glm(sd ~  as_factor(sexo) + l1 + factor(i4) + neduc_ebs,data = data))
library(DescTools)
PseudoR2(a ,which="McFadden")
a<- glm(sd ~  as_factor(sexo) + l1 + factor(i4) + neduc_ebs,data = data)
PseudoR2(a ,which="McFadden")
screenreg(glm(sd ~  as_factor(sexo) + l1 + factor(i4) + neduc_ebs+ qaut,data = data))
a<- glm(sd ~  as_factor(sexo) + l1 + factor(i4) + neduc_ebs,data = data)
screenreg(a,data = data))
PseudoR2(a ,which="McFadden")
a<- glm(sd ~  as_factor(sexo) + l1 + factor(i4) + neduc_ebs,data = data)
screenreg(a,data = data))
screenreg(a,data = data)
PseudoR2(a ,which="McFadden")
a<- glm(sd ~  as_factor(sexo) + l1 + factor(i4) + neduc_ebs+qaut,data = data)
screenreg(a,data = data)
PseudoR2(a ,which="McFadden")
data<-data %>%
mutate( sd = ifelse(phq4 > 1, 1,0),
i4 = ifelse(i4 == 9,NA, i4))
a<- glm(sd ~  as_factor(sexo) + l1 + factor(i4) + neduc_ebs+qaut,data = data)
screenreg(a,data = data)
PseudoR2(a ,which="McFadden")
data<-data %>%
mutate( sd = ifelse(phq4 > 2, 1,0),
i4 = ifelse(i4 == 9,NA, i4))
summary(data$sd)
a<- glm(sd ~  as_factor(sexo) + l1 + factor(i4) + neduc_ebs+qaut,data = data)
screenreg(a,data = data)
PseudoR2(a ,which="McFadden")
data<-data %>%
mutate( sd = ifelse(phq4 > 1, 1,0),
i4 = ifelse(i4 == 9,NA, i4))
summary(data$sd)
table(data$i4)
data$l1
a<- glm(sd ~  as_factor(sexo) + l1 + factor(i4) + neduc_ebs+qaut,data = data)
screenreg(a,data = data)
PseudoR2(a ,which="McFadden")
a<- glm(sd ~  as_factor(sexo) + l1 + factor(i4) + neduc_ebs+qaut +e5,data = data)
screenreg(a,data = data)
PseudoR2(a ,which="McFadden")
a<- glm(sd ~  as_factor(sexo) + l1 + factor(i4) + neduc_ebs+qaut ,data = data)
screenreg(a,data = data)
PseudoR2(a ,which="McFadden")
a<- glm(sd ~  as_factor(sexo) + l1 + factor(i4) + neduc_ebs+qaut +e5 ,data = data)
a<- glm(sd ~  as_factor(sexo) + l1 + neduc_ebs+qaut +e5 ,data = data)
screenreg(a,data = data)
PseudoR2(a ,which="McFadden")
a<- glm(sd ~  as_factor(sexo) + l1 + factor(neduc_ebs) +e5 ,data = data)
screenreg(a,data = data)
PseudoR2(a ,which="McFadden")
data<-data %>%
mutate( sd = ifelse(phq4 > 1, 1,0),
i4 = ifelse(i4 == 9,NA, i4),
neduc_ebs = ifelse(neduc_ebs== 9,NA, i4))
a<- glm(sd ~  as_factor(sexo) + l1 + factor(neduc_ebs) +e5 ,data = data)
screenreg(a,data = data)
PseudoR2(a ,which="McFadden")
a<- glm(sd ~  as_factor(sexo) + l1 + as_factor(neduc_ebs) +e5 ,data = data)
screenreg(a,data = data)
table(data$neduc_ebs)
# Importar datos
temp <- tempfile() #Creamos un archivo temporal
download.file("https://observatorio.ministeriodesarrollosocial.gob.cl/storage/docs/bienestar-social/Base_de_datos_EBS_2021_SPSS.sav.zip",temp) #descargamos los datos
data <- haven::read_sav(unz(temp, "Base de datos EBS 2021 SPSS.sav")) #cargamos los datos
unlink(temp); remove(temp) #eliminamos el archivo temporal
data<-data %>%
mutate( sd = ifelse(phq4 > 1, 1,0),
i4 = ifelse(i4 == 9,NA, i4),
neduc_ebs = ifelse(neduc_ebs== 9,NA, neduc_ebs))
table(data$neduc_ebs)
a<- glm(sd ~  as_factor(sexo) + l1 + as_factor(neduc_ebs) +e5 ,data = data)
screenreg(a,data = data)
PseudoR2(a ,which="McFadden")
a<- glm(sd ~  as_factor(sexo) + l1 + as_factor(neduc_ebs),data = data)
screenreg(a,data = data)
PseudoR2(a ,which="McFadden")
a<- glm(sd ~  as_factor(sexo) + l1 + as_factor(neduc_ebs) + e5,data = data)
screenreg(a,data = data)
a<- glm(sd ~  as_factor(sexo) + l1 + as_factor(neduc_ebs) + e5,data = data)
or <- texreg::extract(a)
or@coef <- exp(or@coef)
screeneg(or)
screenreg(or)
?screenreg
screenreg(a,data = data, digits = 3)
blogdown:::preview_site()
blogdown:::preview_site()
blogdown:::preview_site()
BLOG
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown:::preview_site()
blogdown:::preview_site()
blogdown::serve_site()
